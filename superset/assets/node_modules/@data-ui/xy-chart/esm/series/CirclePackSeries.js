import _slicedToArray from'babel-runtime/helpers/slicedToArray';import _Object$getPrototypeOf from'babel-runtime/core-js/object/get-prototype-of';import _classCallCheck from'babel-runtime/helpers/classCallCheck';import _createClass from'babel-runtime/helpers/createClass';import _possibleConstructorReturn from'babel-runtime/helpers/possibleConstructorReturn';import _inherits from'babel-runtime/helpers/inherits';import _extends from'babel-runtime/helpers/extends';import React from'react';import PropTypes from'prop-types';import{extent as d3Extent}from'd3-array';import PointSeries,{propTypes as pointSeriesPropTypes,defaultProps as pointSeriesDefaultProps}from'./PointSeries';import computeCirclePack from'../utils/computeCirclePack';var DEFAULT_POINT_SIZE=4,CIRCLE_PACK_LAYOUT_TIMEOUT=10,propTypes=_extends({},pointSeriesPropTypes,{data:PropTypes.arrayOf(PropTypes.shape({x:PropTypes.oneOfType([PropTypes.number,PropTypes.object,PropTypes.instanceOf(Date)]),size:PropTypes.number})).isRequired,layoutCallback:PropTypes.func,layout:PropTypes.func}),defaultProps=_extends({},pointSeriesDefaultProps,{size:function size(a){return a.size||4},layoutCallback:null,layout:computeCirclePack}),CirclePackSeries=function(a){function b(a){_classCallCheck(this,b);var c=_possibleConstructorReturn(this,(b.__proto__||_Object$getPrototypeOf(b)).call(this,a));return c.computeCirclePack=c.computeCirclePack.bind(c),c.state={data:c.computeCirclePack(a)},c}return _inherits(b,a),_createClass(b,[{key:'componentWillReceiveProps',value:function componentWillReceiveProps(a){var b=this;['data','xScale','size'].some(function(c){return b.props[c]!==a[c]})&&this.setState({data:this.computeCirclePack(a)})}},{key:'componentWillUnmount',value:function componentWillUnmount(){this.timeout&&clearTimeout(this.timeout)}},{key:'computeCirclePack',value:function(a){var b=a.data,c=a.xScale,d=a.yScale,e=a.size,f=a.layoutCallback,g=a.layout,h=g(b,c,e);if(f){this.timeout&&clearTimeout(this.timeout);var i=d3Extent(h,function(a){return a.y}),j=_slicedToArray(i,2),k=j[0],l=j[1];this.timeout=setTimeout(function(){f({range:[k,l],domain:[d(k),d(l)]})},10)}return h}},{key:'render',value:function render(){var a=this.state.data;return React.createElement(PointSeries,_extends({},this.props,{data:a}))}}]),b}(React.PureComponent);CirclePackSeries.propTypes=propTypes,CirclePackSeries.defaultProps=defaultProps,CirclePackSeries.displayName='CirclePackSeries';export default CirclePackSeries;