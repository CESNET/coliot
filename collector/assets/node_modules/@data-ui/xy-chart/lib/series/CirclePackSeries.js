'use strict';var _slicedToArray2=require('babel-runtime/helpers/slicedToArray'),_slicedToArray3=_interopRequireDefault(_slicedToArray2),_getPrototypeOf=require('babel-runtime/core-js/object/get-prototype-of'),_getPrototypeOf2=_interopRequireDefault(_getPrototypeOf),_classCallCheck2=require('babel-runtime/helpers/classCallCheck'),_classCallCheck3=_interopRequireDefault(_classCallCheck2),_createClass2=require('babel-runtime/helpers/createClass'),_createClass3=_interopRequireDefault(_createClass2),_possibleConstructorReturn2=require('babel-runtime/helpers/possibleConstructorReturn'),_possibleConstructorReturn3=_interopRequireDefault(_possibleConstructorReturn2),_inherits2=require('babel-runtime/helpers/inherits'),_inherits3=_interopRequireDefault(_inherits2),_extends2=require('babel-runtime/helpers/extends'),_extends3=_interopRequireDefault(_extends2),_react=require('react'),_react2=_interopRequireDefault(_react),_propTypes=require('prop-types'),_propTypes2=_interopRequireDefault(_propTypes),_d3Array=require('d3-array'),_PointSeries=require('./PointSeries'),_PointSeries2=_interopRequireDefault(_PointSeries),_computeCirclePack=require('../utils/computeCirclePack'),_computeCirclePack2=_interopRequireDefault(_computeCirclePack);Object.defineProperty(exports,'__esModule',{value:!0});function _interopRequireDefault(a){return a&&a.__esModule?a:{default:a}}var DEFAULT_POINT_SIZE=4,CIRCLE_PACK_LAYOUT_TIMEOUT=10,propTypes=(0,_extends3.default)({},_PointSeries.propTypes,{data:_propTypes2.default.arrayOf(_propTypes2.default.shape({x:_propTypes2.default.oneOfType([_propTypes2.default.number,_propTypes2.default.object,_propTypes2.default.instanceOf(Date)]),size:_propTypes2.default.number})).isRequired,layoutCallback:_propTypes2.default.func,layout:_propTypes2.default.func}),defaultProps=(0,_extends3.default)({},_PointSeries.defaultProps,{size:function size(a){return a.size||4},layoutCallback:null,layout:_computeCirclePack2.default}),CirclePackSeries=function(a){function b(a){(0,_classCallCheck3.default)(this,b);var c=(0,_possibleConstructorReturn3.default)(this,(b.__proto__||(0,_getPrototypeOf2.default)(b)).call(this,a));return c.computeCirclePack=c.computeCirclePack.bind(c),c.state={data:c.computeCirclePack(a)},c}return(0,_inherits3.default)(b,a),(0,_createClass3.default)(b,[{key:'componentWillReceiveProps',value:function componentWillReceiveProps(a){var b=this;['data','xScale','size'].some(function(c){return b.props[c]!==a[c]})&&this.setState({data:this.computeCirclePack(a)})}},{key:'componentWillUnmount',value:function componentWillUnmount(){this.timeout&&clearTimeout(this.timeout)}},{key:'computeCirclePack',value:function computeCirclePack(a){var b=a.data,c=a.xScale,d=a.yScale,e=a.size,f=a.layoutCallback,g=a.layout,h=g(b,c,e);if(f){this.timeout&&clearTimeout(this.timeout);var i=(0,_d3Array.extent)(h,function(a){return a.y}),j=(0,_slicedToArray3.default)(i,2),k=j[0],l=j[1];this.timeout=setTimeout(function(){f({range:[k,l],domain:[d(k),d(l)]})},10)}return h}},{key:'render',value:function render(){var a=this.state.data;return _react2.default.createElement(_PointSeries2.default,(0,_extends3.default)({},this.props,{data:a}))}}]),b}(_react2.default.PureComponent);CirclePackSeries.propTypes=propTypes,CirclePackSeries.defaultProps=defaultProps,CirclePackSeries.displayName='CirclePackSeries',exports.default=CirclePackSeries;