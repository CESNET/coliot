import _extends from"babel-runtime/helpers/extends";var DEFAULT_POINT_SIZE=4;function packCircles(a,b){function d(a,b){b.xMin=o(a.px-a.r,b.xMin),b.xMax=m(a.px+a.r,b.xMax),b.yMin=o(a.py-a.r,b.yMin),b.yMax=m(a.py+a.r,b.yMax)}function e(a,b){return a.x+a.r<b.xMin||a.x-a.r>b.xMax}function c(a,b){for(var c=[],d=a.nextPack;d!==a;d=d.nextPack)d.px+d.r<b.x-b.r||d.px-d.r>b.x+b.r||d.px-d.r-b.r<t||d.px+d.r+b.r>u||c.push(d);return 0===c.length?a:(c.sort(function(c,a){var b=Math.abs;return b(c.py)-b(a.py)}),c[0])}function f(d,a){var b=d.nextPack;d.nextPack=a,a.prevPack=d,a.nextPack=b,b.prevPack=a}function g(d,a,b){var c=d.r+b.r,e=a.px-d.px,f=a.py-d.py;if(c&&(e||f)){var g=a.r+b.r,h=e*e+f*f;g*=g,c*=c;var i=.5+(c-g)/(2*h),j=Math.sqrt(m(0,2*g*(c+h)-(c-=h)*c-g*g))/(2*h);b.px=d.px+i*e+j*f,b.py=d.py+i*f-j*e}else b.px=d.px+c,b.py=d.py}function h(c,a){var b=a.px-c.px,d=a.py-c.py,e=c.r+a.r;return .999*e*e>b*b+d*d}function l(c,a){c.nextPack=a,a.prevPack=c}function j(a){a.nextPack=a,a.prevPack=a}function k(m,o,p){var n,q,s,t,u,v,w=r[p];if(1<=m.length-o&&(n=m[o],n.px=n.x,n.py=0,d(n,w),2<=m.length-o)){if(e(m[o+1],w))return o+1;if(q=m[o+1],q.px=n.x+n.r+q.r,q.py=0,d(q,w),f(n,q),3<=m.length-o){if(e(m[o+2],w))return o+2;s=m[o+2],g(n,q,s),d(s,w),f(n,s);var x=!1;for(t=o+3;t<m.length;t+=1){if(!x){if(e(m[t],w))return t;n=c(n,m[t]),q=n.nextPack}g(n,q,s=m[t]);var y=0,z=1,A=1;for(u=q.nextPack;u!==q;u=u.nextPack,z+=1)if(h(u,s)){y=1;break}if(1==y)for(v=n.prevPack;v!==u.prevPack&&!h(v,s);v=v.prevPack,A+=1);y?(z<A||z==A&&q.r<n.r?l(n,q=u):l(n=v,q),t-=1,x=!0):(f(n,s),q=s,d(s,w),x=!1)}}}return m.length}var m=Math.max,o=Math.min,q=2<arguments.length&&void 0!==arguments[2]?arguments[2]:function(a){return a.size||4},r=[],s=[],t=b(a[0].x),u=b(a[a.length-1].x),v={xMin:0,yMin:0,xMax:0,yMax:0},w={up:[],down:[]};if(0===a.length)return a;var x=[];a.forEach(function(a){x.push(_extends({},a,{x:b(a.x),r:q(a)}))});for(var y=0;y<x.length;y+=1)j(x[y]);for(var z=0,i=0;z<x.length;){r.push({xMin:Infinity,yMin:Infinity,xMax:-Infinity,yMax:-Infinity}),z=k(x,z,i),s.push(x[z-1]);for(var n=x[z-1].nextPack;n!==x[z-1];n=n.nextPack)s.push(n);i+=1}return v.xMin=Infinity,v.xMax=-Infinity,v.yMin=Infinity,v.yMax=-Infinity,r.forEach(function(a){v.xMin=o(v.xMin,a.xMin),v.xMax=m(v.xMax,a.xMax),v.yMin=o(v.yMin,a.yMin),v.yMax=m(v.yMax,a.yMax)}),s.sort(function(c,a){return c.px-a.px}),s.forEach(function(a){0>a.py?w.up.push(a):0<a.py?w.down.push(a):(w.up.push(a),w.down.push(a))}),x}export default function computeCirclePack(a,b,c){for(var d=a.sort(function(c,a){return c.x-a.x}),e=packCircles(a,b,c),f=[],g=0;g<e.length;g+=1)f.push(_extends({},d[g],{x:b.invert(e[g].px),y:e[g].py}));return f}